# 2023 Tianjin CTF writeup by Beckoning



# Crypto

## xor

> d31wdmp1JiMmIiZydyBydCcoKXIkKXAncCckcClwICh1c3MlKWw=



## 套娃

```python
from Crypto.Util.number import getPrime
from gmpy2 import *
from flag import flag

flag=flag[5:-1]

def genPrime(bit):
    while 1:
        res=getPrime(bit)
        if res%4==1:
            return res

p=genPrime(500)
q=genPrime(500)
flag=int(flag,16)
n=p*q
e=524296
assert (flag**8)//n>0
c=pow(flag,e,n)
print n
print c



p_add_q=p+q
x=next_prime(p_add_q**2)


p1=getPrime(512)
q1=getPrime(512)
n1=p1*q1
e1=17
d1=invert(e1,(q1-1)*(p1-1))
mask=2**512-1
d_=d1&mask
c1=pow(x,e1,n1)
print n1
print c1


p2=getPrime(512)
q2=getPrime(512)
n2=p2*q2
e2=65537
c2=pow(d_,e2,n2)
print n2
print c2
print p2>>100<<100



'''
10331372002120584355251416207830311715899412485023470912442143171889036926476843754712976101558153750317054786745493216804737216078196368729890969243697999879852913095476724096159212438959645547953466921320442800034334791483054604960368093095837293491359266241933395348955738093437846281215347201734529
1783297741764281329186540431324988622651752973641069118993260742104715577241901316417849709659119317150510631636818154312355332281636963981490767465705130465850621398438573816131489766545141973180451061855371863470769458594014783710646393277237155147959034067435504036861783575509172278013632786276581
68610456806272184681514876799580479682714034464059957504767052136164781411339448283761741873052163767913436690199848081964426824527042601915933339086810664168921146128526554216708519349215558638895138460809297101925674401953461902293291945788943591680341512394978460779427859899316955806993298509932155641601
17780963571079254738929036677779361346662715668801482065039514508825929195365515114887074697061333422521300288776369181027756863618138691515714905518410866743321409702003749963006093515324717560480978468083189168179742817938848292684615717966122480979872095851782342866093412896265099891002077134568291285298
84729760009849967186184983326256918486401097646584328625028795688523860065763159336123825142793230277675092933425798947600584452154093648940902005157921973265670255348642178792906931931965997131913459548472778038876700013865055634495555869418514028907454123670677338082431412662535529678818645133493688149923
82320677529863296930589631146912496575888189418954828291929114903339296566307469131782857778100887475233355666584996142990805845794938506117998067287852736518056491096109663562779803440222993387796705676447266559005164097050826995222085124913021242517733861648134109404552824974685823243882790282321388098509
10899875761470411548437012990576361377711070151934892011969350978736050820069194860938020069360883489522555129515726020169137808646329169432833767210221568
'''
```

